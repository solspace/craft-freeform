{% macro getFieldTemplate(type) -%}
    {% set fieldTemplatePath = "freeform/_defaultFormTemplates/bootstrap-3/fields/" %}
    {{- fieldTemplatePath ~ type ~ ".twig" -}}
{%- endmacro %}

{% macro render(row, form) %}
    {% import _self as self %}

    {% set width = (12 / (row|length)) %}

    <div{{ form.attributes.row }}>
        {% for cell in row %}
            {% set field = cell.field %}

            {% set containerClass = [] %}

            {% if field.type != "field" %}
                {% if field.type in ["checkbox", "mailing_list"] %}
                    {% set containerClass = containerClass|merge(["checkbox"]) %}
                {% else %}
                    {% set containerClass = containerClass|merge(["form-group"]) %}
                {% endif %}
            {% endif %}

            {% if field.errors|length %}
                {% set containerClass = containerClass|merge(["has-error"]) %}
            {% endif %}

            {% set containerClass = containerClass|merge(["col-xs-12", "col-sm-"~width]) %}

            {% set properties = {
                attributes: {
                    container: { class: containerClass },
                    label: { class: (field.required ? "required") },
                    input: { class: "form-control" },
                    instructions: { class: "help-block" },
                    error: { class: "help-block" },
                },
            } %}

            {% include [self.getFieldTemplate(field.type), self.getFieldTemplate("_default")] %}

        {% endfor %}
    </div>

{% endmacro %}
