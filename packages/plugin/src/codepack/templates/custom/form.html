{% extends "demo/_layout" %}

{% set pageTitle = "Custom" %}
{% set page = "custom" %}

{% set formHandle = craft.app.request.segment(3) %}
{% set form = craft.freeform.form(formHandle) %}

{% set isSuccess  = craft.app.request.segment(4) == "success" %}

{% block content %}

    <div class="container">
        {% set formTemplate = form.settings.general.formattingTemplate %}

        {# Display a tip for demo templates #}
        <div class="alert alert-info" role="alert">
            <h5 class="alert-heading">For your information...</h5>
            <p class="mb-0">
                You currently have the <b><i>{{ formTemplate }}</i></b> formatting template assigned to this form. Within your regular site templates,
                be sure to specify any necessary CSS, JS and framework libraries to have the correct styles show up for the form.
            </p>

        {% if formTemplate == "foundation-6.twig" %}
            <hr>
            <p class="mb-0">
                We've detected you're using the <b>Foundation</b> sample formatting template and have automatically loaded the Foundation library inside this demo.
                The Bootstrap library is also loaded by default, so you may see some style conflicts in the demo area.
            </p>
        {% elseif formTemplate == "tailwind-1.twig" %}
            <hr>
            <p class="mb-0">
                We've detected you're using the <b>Tailwind</b> sample formatting template and have automatically loaded the Tailwind library inside this demo.
                The Bootstrap library is also loaded by default, so you may see some style conflicts in the demo area.
            </p>
        {% elseif ( formTemplate == "bootstrap-4/index.twig" ) or ( formTemplate == "bootstrap-5/index.twig" ) %}
            <hr>
            <p class="mb-0">
                We've detected you're using the <b>Bootstrap</b> sample formatting template and have automatically loaded the Bootstrap library inside this demo.
            </p>
        {% endif %}
        </div>

        {# Display a tip for forms with submit limit setting enabled #}
        {% set limit = form.settings.behavior.limitSubmissions %}
        {% if limit %}
            <div class="alert alert-warning">
                <h5 class="alert-heading">Please note...</h5>
                <p class="mb-0">
                    You currently have a user submit limit setting enabled (<i>
                        {%- if limit == "auth_unlimited" -%}
                            Logged in Users only (no limit)
                        {%- elseif limit == "cookie" -%}
                            Once per Cookie
                        {%- elseif limit == "ip_cookie" -%}
                            Once per IP/Cookie combo
                        {%- elseif limit == "auth" -%}
                            Once per logged in Users
                        {%- elseif limit == "auth_cookie" -%}
                            Once per logged in User or Guest Cookie
                        {%- elseif limit == "auth_ip_cookie" -%}
                            Once per logged in User or Guest IP/Cookie combo
                        {%- else -%}
                            '{{ limit }}'
                        {%- endif -%}
                    </i>) for this form.
                </p>
            </div>
        {% endif %}

        {% if isSuccess %}
            <div class="alert alert-success" role="alert">
                {{ form.successMessage | t }}
            </div>
        {% endif %}

        {% if form %}

            <h3 class="mb-5">{{ form.name }}</h3>

            {{ form.render }}

        {% else %}
            <div class="alert alert-danger">
                Form with the handle '{{ formHandle }}' does not exist.
            </div>
        {% endif %}

    </div>

{% endblock %}

{% block headerCss %}
    {{ parent() }}
    {% if form %}
        {% set formTemplate = form.settings.general.formattingTemplate %}

        {% if formTemplate == "foundation-6.twig" %}
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.5.3/css/foundation.min.css">
            <style>
                [type=checkbox], [type=file], [type=radio] {
                    margin: 0;
                }
                ul.menu .is-active {
                    color: white;
                    background: grey;
                }
            </style>
        {% endif %}
        {% if formTemplate == "tailwind-1.twig" %}
            <link rel="stylesheet" href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css">
        {% endif %}
    {% endif %}
{% endblock %}

{% block footerJs %}
    {{ parent() }}
    {% if form %}
        {% set formTemplate = form.settings.general.formattingTemplate %}

        {% if formTemplate == "foundation-6.twig" %}
            <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.5.3/js/foundation.min.js"></script>
        {% endif %}
    {% endif %}
{% endblock %}

